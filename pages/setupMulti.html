<!DOCTYPE html>
<html>
<head>
   <title></title>
</head>
<!-- UI Functions -->
<script type="text/javascript">
   function joinMultiplayer(event,obj){
      if (event.key === "Enter") {
         var val = obj.value;
         if(val != ""){
            joinChannel(val);
            document.getElementById("join_id").style.display = "none";
            document.getElementById("exitMultiplayer").style.display = "";
            document.getElementById("hasJoined").style.display = "";
            document.getElementById("hasJoined").innerText = "Joined: "+val+" âœ”";

         }
      }
   }
   function startMultiGame(){
      document.isSinglePlayerGame = false;
      var msg = {
         "board" : document.board,
         "time" : document.setupTime,
         "numPlayers" : document.otherPlayers.size
      }
      sendMessage(msg,MessageType.initialBoards);
   }
   function changeTimeMulti(change){
      var time = document.setupTime / 60000;

      time += change;
      if(time > 5) time = Math.min(10,time);
      else time = 5;

      setClock(time,0,"clockdiv_setup_multi");

      document.setupTime = time * 60000;
   }

   function toggleHost(isHost){
      if(isHost){
         var seed = startChannel();
         document.board = shuffledBoard();
         document.multiplayerSeed = seed;
         document.getElementById("game_id").innerText = seed;
         document.getElementById("host").style.display = "";
         document.getElementById("join").style.display = "none";
         document.getElementById("startGameMultiButton").style.display = "";

      }
      else {
         document.board = null;
         document.getElementById("host").style.display = "none";
         document.getElementById("join").style.display = "";
         document.getElementById("startGameMultiButton").style.display = "none";

      }
   }

   function exitMultiplayerSession(){
      removePlayer(document.me);
      unsubscribe();

      document.getElementById("exitMultiplayer").style.display = "none";
      document.getElementById("join_id").style.display = "";
      document.getElementById("hasJoined").style.display = "none";
   }

   function mainMenu_setupMulti(){

      //TODO Unsubscribe stuff
            // Go to main menu
      toggleVisiblePage(Pages.mainMenu);
   }

</script>
<body>
   <div class = "setupMulti">
      <div id = "leftMenu_setup_multi" class="leftSide" style="display: none">
         <i class="fa fa-arrow-circle-left fa-4x icon" onclick="mainMenu_setupMulti()"></i> 
    </div>
    <div class="centerContent">
      <p>Please select one: </p>
      <input type="radio" name="host" value="1" onchange="toggleHost(true)"> Host<br>
      <input type="radio" name="host" value="0" onchange="toggleHost(false)"> Join<br>
   </div>
   <div id = "host" class="" style = "display: none">
      <div class="centerContent">
         <div id="clockdiv_setup_multi" class = "timer">
            <span class="timerFont minutes">05</span>:<span class="timerFont seconds">00</span>
         </div>
      </div>
      <div class="centerContent">
         <button onclick="changeTimeMulti(1)">+</button>
         <button onclick="changeTimeMulti(-1)">-</button>
      </div>
      <div class="centerContent">
         Game ID: 
         <p id="game_id"></p>
      </div>
      <div class="centerContent">
         <div class="wrap">
            <table class="joinedPlayersTable">
               <tr>
                  <td>Joined</td>
                  <td>Remove</td>
               </tr>
            </table>
            <div class="inner_table">
               <table id="playersList">
               </table>
            </div>
         </div>
      </div>
      <br/>
      <div class="centerContent" id = "startGameMultiButton" style = "display: none">
         <i class="fa fa-play fa-2x icon" onclick="startMultiGame()"></i> 
      </div>
   </div>
   <div>
      <div id = "join" style="display:none">
         <input id="join_id" style="border-radius: 1px; width: 150px; margin-bottom: 50px;" onkeyup="joinMultiplayer(event,this)"/>
         <div>
            <span id = "hasJoined" style="display: none"></span>
            <i id ="exitMultiplayer" class=" fa fa-times" style="display: none" onclick="exitMultiplayerSession()"></i>
         </div>
      </div>
   </div>
</div>
</body>
</html>